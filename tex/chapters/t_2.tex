\documentclass[../../TAU.tex]{subfiles}
\begin{document}

\chapter{Математическое описание непрерывных систем уравнений} 

    В ТАУ при анализе и синтезе САУ рассматриваются их {\it математические модели}.
    \defi{\it Математическая модель} (ММ) - уравнения, переходные и временные функции, которые описывают процессы, происходящие в САУ.
    Существует два способа получения ММ: теоретический и экспериментальный.\par
    {\it Теоретический метод} заключается в аналитическом исследовании физической сущности процесса с использованием общих законов физики, или процессов с использованием материального и энергетического баланса. Применение чисто теоретического метода представляет большую трудность вследствие сложности явлений, происходящих в процессах, или недостаточной степени изученности их.
    {\it Экспериментальный метод} математического описания заклю­чается в обработке экспериментальных данных, полученных непо­средственно на действующих объектах производства, или на полу­промышленной лабораторной машине, или физической модели про­цесса — стенде.\par
    Наиболее эффективным методом получения математической модели является сочетание {\itтеоретического} и {\it экспериментального} ме­тодов. При этом на долю теоретического метода приходится анализ в основном структурных свойств объекта и продуктов и получение общего вида уравнений, а на долю экспериментального — количе­ственный анализ и проверка теоретических выводов.\par
    При построении ММ неизбежно возникают противоречивые требования: достаточная точность модели и доступность, или простота, анализа модели. Чем выше точность модели, тем она сложнее; чем проще исследовать ММ, тем она проще. Цель, которую ставит перед собой разработчик или исследователь, разрешает данное противоречие. 


\section{Уравнения динамики и статики}

    Любой элемент (часть) САУ осуществляет преобразование входа 
    $g$ (или $u$) в выход $y$:
    \begin{equation}
        y(t) = A g(t),
    \end{equation}
    где $A$ --- оператор САУ. В этом курсе мы будем рассматривать только оператор $A$, описываемый обыкновенными дифференциальными уравнениями (ОДУ). Введем два вида уравнений, рассматриваемых в ТАУ.
    \defi{\it Уравнение статики} - уравнение, описывающее статический (установившийся) режим.
    \defi {\it Уравнение динамики} - уравнение, описывающее процесс в звене при произвольных входных воздействиях.
    Пусть дано ОДУ некоторого ОУ вида
    \begin{equation}\label{EQ_DYNAMIC}
        F(y,\dot y, \ddot y, u, \dot u, v) = 0,
    \end{equation}
    где $F$ --- функция нескольких переменных, $y$ и $u$ --- выход и управление, $v$ --- возмущение.
    Пусть при $u=u^0$ и $v=v^0$ со временем выход $y$ принимает постоянное значение: $y=y^0$. Тогда уравнение 
    \eref{EQ_DYNAMIC} 
    примет вид
    \begin{equation}\label{EQ_STATIC}
        F^0=F(y^0, 0, 0, u^0, 0, v^0) = 0.
    \end{equation}
    Уравнение 
    \eref{EQ_STATIC} 
    называется уравнением статики, уравнение 
    \eref{EQ_DYNAMIC} 
    называют уравнением динамики.

\subsection[Звено САУ]{Звено САУ\footnote{См. \cite[стр. 21-22]{kim:uch}}}
    
    \defi{\it Звеном} называют ММ либо части САУ, либо САУ целиком. Понятие звена удобно использовать для представления САУ в виде соединения нескольких звеньев, т.е. более простых ММ.

    Одно из самых простых звеньев - это усилитель, Пропорциональное звено. Его уравнение можно записать в виде
    \begin{equation}
        y = ku.
    \end{equation}
    Уравнение динамики здесь совпадает с уравнением статики (точнее, динамики просто нет). Такого рода преобразования часто обозначают графически в виде блока.
    \begin{figure}[h]
        \centering
        \includegraphics[width=5.5cm]{block_gain.pdf}
        \caption{Статическая характеристика П-звена}
        \centering
    \end{figure}

\subsection{Линеаризация}

    Назначение САУ - это поддержание определенного заданного режима. Поэтому параметры, описывающие САУ, не должны сильно отличаться от заданного режима. Эта простая идея обычно позволяет проводить операцию линеаризации.
    \defi{\it Линеаризация} - построение приближенной линейной модели на основе более реалистичной нелинейной модели.
    Рассмотрим пример для уравнения 
    \eref{EQ_DYNAMIC}.
    Пусть заданный режим имеет вид
    \begin{equation}
        y = y^0, \dot y = \ddot y = 0, u=u^0, \dot u = 0, v=v^0.
    \end{equation}
    Тогда реальные параметры САУ можно записать в отклонениях как
    \begin{equation}
        y = y^0+\Delta y,\;\dot y = \dot{\Delta y},\;\ddot y = \ddot{\Delta y},\; u = u^0 + \Delta u,\; \dot u = \dot{\Delta u},\;v = v^0 + \Delta v,
    \end{equation}
    где переменные со знаком $\Delta$ достаточно малы.

    Тогда для функции
    $F(y,\dot y, \ddot y, u, \dot u, v)$ 
    воспользуемся разложением в ряд Тейлора в точке 
    $(y^0, 0,0, u^0, 0, v^0)$:
    \begin{multline}
        F(y,\dot y, \ddot y, u, \dot u, v) = F^0 + \frac{\partial F}{\partial y} \Delta y +\frac{\partial F}{\partial \dot y} \dot{\Delta y}+ \frac{\partial F}{\partial \ddot y} \ddot{\Delta y} +\\  + \frac{\partial F}{\partial u} \Delta u + \frac{\partial F}{\partial \dot u } \dot{\Delta u} + \frac{\partial F}{\partial v} \Delta v + \ldots,
    \end{multline}
    где $F^0= 0$, многоточием обозначены члены с более высоким порядком малости.
    Отсюда получают линеаризацию уравнения 
    \eref{EQ_DYNAMIC} 
    вида
    \begin{equation}\label{EQ_LINEAR}
        \alpha_2\ddot{\Delta y} + \alpha_1 \dot{\Delta y} + \alpha_0 \Delta y - \beta_1\dot{\Delta u} - \beta_0\Delta u - c_0 \Delta v = 0,
    \end{equation}
    где 
    $a_0 = \frac{\partial F}{\partial y}$, 
    $a_1 = \frac{\partial F}{\partial \dot y}$, $a_2 = \frac{\partial F}{\partial \ddot y}$, 
    $\beta_0 = -\frac{\partial F}{\partial u}$, 
    $\beta_1 = -\frac{\partial F}{\partial \dot u }$ и 
    $c_0 = -\frac{\partial F}{\partial v}$.
    Введем оператор дифференцирования: 
    $s = \frac{d}{dt}$.
    Тогда уравнение 
    \eref{EQ_LINEAR}
     примет вид (знаки $\Delta$ опущены)
    \begin{equation}
        \alpha_2 s^2 y + \alpha_1 s y + \alpha_0 y = \beta_1 s u + \beta_0 u + c_0 v,
    \end{equation}
    что эквивалентно
    \begin{equation}
        Q(s) y = R_1(s)u + R_2(s)v,
    \end{equation}
    где 
    $Q(s) = \alpha_2s^2 + \alpha_1 s + \alpha_0$ 
    называют {\it собственным оператором}, а 
    $R_1(s) = \beta_1s+\beta_0$ и 
    $R_2(s) = c_0$
     --- {\it операторами воздействия}.
    \defi{\it Собственный оператор} - дифференциальный оператор $Q(s)$ при выходной величине.
    \defi{\it Оператор воздействия} - дифференциальный оператор $R(s)$ при входной величине.
    
\section{Преобразование Лапласа}

    Для исследования и описания ОДУ часто используют преобразование Лапласа, так как оно сводит решение дифференциальных уравнений к алгебраическим операциям.
    \defi{\it Преобразованием Лапласа} называют отображение 
    $\LAP{\cdot}$ 
    функции 
    $x(t), t\in\BF{R}$
     в функцию 
    $X(s), s\in\BF{C}$
    , осуществляемое по правилу
    \begin{equation}
        X(s) = \LAP{x(t)} \stackrel{def}{=} \int\limits_0^\infty e^{-st} x(t) dt,
    \end{equation}
    где $x(t)$ --- исходная функция, $X(s)$ --- изображение по Лапласу, $s$~---~переменная преобразования Лапласа.
    Условия, при которых преобразование существует для $x(t)$:
    \begin{enumerate}
        \item $x(t)$ --- интегрируемая на любом конечном интервале функция;
        \item $x(t)\equiv0$ при $t < 0$;
        \item $\exists c, M > 0: |x(t)| < M e^{ct}, \forall t \ge 0$.
    \end{enumerate}
    Если $x(t)$ удовлетворяет всем вышеперечисленным свойствам, то её называют функцией-оригиналом.

\subsection{Обратное преобразование Лапласа}

    Соотношение, определяющее по известному изображению его оригинал, называют {\it обратным преобразованием Лапласа}. 
    \begin{equation}
        x(t) = \INVLAP{X(s)} = \frac{1}{2\pi j} \int\limits_{\sigma-j\infty}^{\sigma + j\infty} X(s)e^{st} ds,
    \end{equation}
    где интегрирование ведется вдоль любой прямой 
    $\RE{s} = \sigma > c$, 
    где $c$ --- константа из условий существования преобразования Лапласа для $x(t)$.

\subsection{Свойства преобразования Лапласа и примеры} 

    Пусть 
    $X(s) = \LAP{x(t)}$ и 
    $Y(s) = \LAP{y(t)}$.
    \begin{enumerate}
        \item Линейность. $\LAP{\alpha x(t) + \beta y(t)} = \alpha X(s) + \beta Y(s);$
        \item Дифференцирование оригинала. \\
            Если производная 
            $\dot x(t)$ 
            является функцией-оригиналом, то 
            $\LAP{\dot x(t)} = sX(s) - x(0);$
        \item Интегрирование оригинала.
            \begin{equation}
                \LAP{\int\limits_0^tx(\tau)d\tau} = \frac{X(s)}{s};
            \end{equation}
        \item Теорема запаздывания. Для любого $\tau>0$:
            \begin{equation}
                \LAP{x(t-\tau)} = e^{-\tau s}X(s);
            \end{equation}
        \item  Теорема о свертке (или об умножении изображений).\\
            Если $x(t)$ и $y(t)$ - оригиналы изображений, а $X(t)$ и $Y(t)$ - их изображения, то
            \begin{equation}
                X(s)\cdot Y(s) = \LAP{\int\limits_0^tx(\tau)y(t-\tau)d\tau} = \LAP{\int\limits_0^ty(\tau)x(t-\tau)d\tau};
            \end{equation}
            Интеграл в правой части называют {\it сверткой функций} $x_1(t)$ и $x_2(t)$, его обозначают $x_1(t) * x_2(t)$:
            \begin{equation}
                x_1(t)*x_2(t) = \int\limits_0^t x_1(\tau) x_2(t-\tau) d{\tau} = \int\limits_0^t x_2(\tau) x_1(t-\tau)d\tau.
            \end{equation}
            Поэтому 
            \begin{equation}
                X_1(s) \cdot X_2(s) = \LAP{x_1(t) * x_2(t)}
            \end{equation}
        \item Теорема о предельных значениях.
            \begin{enumerate}[label*={\arabic*}]
                \item 
                    $x(0) = \lim\limits_{s\rightarrow\infty}sX(s)$;
                \item Если существует 
                    $x(\infty) = \lim\limits_{t\rightarrow\infty} x(t)$, тогда 
                    $x(\infty) = \lim\limits_{s\rightarrow0} sX(s)$.
            \end{enumerate}
        \item Теорема разложения. \\
            Если изображение по Лапласу есть дробно-рациональная функция, т.е. 
            $X(s) = \frac{B(s)}{A(s)}$, где 
            $A(s)$ и $B(s)$ --- полиномы от $s$ и 
            $\deg A(s) > \deg B(s)$. 
            Тогда
            \begin{equation}
                x(t) = \sum_{k=1}^q\frac{1}{(n_k-1)!}\lim\limits_{s\rightarrow s_k} \frac{d^{n_k-1}}{d s^{n_k-1}} (X(s)(s-s_k)^{n_k}e^{ts}),
            \end{equation}
            где $s_k$ --- корни уравнения 
            $A(s)=0$, $n_k$ --- кратность $k$-го корня, $q$ --- количество различных корней.
            Когда $q=n$ (все корни простые), тогда
            \begin{equation}\label{eq:razl}
                x(t) = \sum^{n}_{k=1}\frac{B(s_k)}{A'(s_k)} e^{s_kt}.
            \end{equation}
    \end{enumerate}
    \examp Определить функцию $x(t)$, изображение которой имеет вид 
    $
        X(s) = \frac{1}{s (s+1)}.
    $\\
    {\bf Решение}\par
    В данном случае
    \begin{equation}
        B(s) = 1,\ A(s) = s (s+1),\ A'(s) = 2 s + 1.
    \end{equation}
    Полюсами функции $X(s)$ являются $s_1 = 0$, $s_2 = -1$, и они являются простыми. Поэтому, согласно формуле \eref{eq:razl} $x(t)=1-e^{-t}$
    \begin{table}[H]
        \begin{center}
            \begin{tabular}{|c|c|c|}
            \hline 
            № & Оригинал $x(t)$ & Изображение $X(s)$\\ \hline
            1 & $\delta(t)$ & $1$ \\ \hline
            2 & $1(t)$ & $\frac{1}{s}$ \\ \hline
            3 & $1(t-\tau)$ & $\frac{1}{s} e^{-\tau s}$ \\ \hline
            4 & $t$ & $\frac{1}{s^2}$ \\ \hline
            5 & $t^n$ & $\frac{n!}{s^{n+1}}$ \\ \hline
            6 & $e^{-\alpha t}$ & $\frac{1}{s+\alpha}$ \\ \hline
            7 & $t e^{-\alpha t}$ & $\frac{1}{(s+\alpha)^2}$ \\ \hline
            8 & $t^n e^{-\alpha t}$ & $\frac{n!}{(s+\alpha)^{n+1}}$ \\ \hline
            9 & $\sin{\omega t}$ & $\frac{\omega}{s^2 + \omega^2}$ \\ \hline
            10 & $\cos{\omega t}$ & $\frac{s}{s^2+\omega^2}$ \\ \hline
            11 & $e^{-\alpha t} \sin{\omega t}$ & $\frac{\omega}{(s+\alpha)^2+\omega^2}$ \\ \hline
            12 & $e^{-\alpha t} \cos{\omega t}$ & $\frac{s+\alpha}{(s+\alpha)^2+\omega^2}$ \\ \hline
            \end{tabular}
            \caption{Изображения Лапласа для часто используемых функций}
        \end{center}
    \end{table}
 
 \subsection{Передаточная функция в изображениях Лапласа}

    Рассмотрим линейное уравнение с постоянными коэффициентами вида
    \begin{equation}\label{EQ_ODU}
    y^{(n)} + \alpha_{n-1}y^{(n-1)} + \ldots + \alpha_1 \dot y + \alpha_0y = \beta_m u^{(m)} + \ldots + \beta_1 \dot u + \beta_0 u,
    \end{equation}
    при нулевых начальных условиях, т.е. 
    $y^{(n-1)} (0) = \ldots = \dot y(0) = y(0) = 0, u^{(m-1)} (0) = \ldots = \dot u(0) = u(0) = 0$ при $x(0)=0$, где $x$ --- вектор состояния системы.
    Применяя к обеим частям равенства преобразование Лапласа, получим
    \begin{equation}\label{EQ_W}
    \left(s^n + \sum_{i=0}^{n-1}\alpha_is^i\right) Y(s) = \left(\sum_{i=0}^{m}\beta_is^i\right) U(s),
    \end{equation}
    где $Y(s) = \LAP{y(t)}$, $U(s) = \LAP{u(t)}$. Разделив уравнение \eref{EQ_W} на полином в левой части, получим
    \begin{equation}  
        Y(s) = W(s)U(s),
    \end{equation}
    где 
    $W(s) = \frac{\beta(s)}{\alpha(s)}$, 
    $\alpha(s) = s^n + \sum_{i=0}^{n-1}\alpha_is^i$ и 
    $\beta(s) = \sum_{i=0}^{m}\beta_is^i$.
    \defi{\it Передаточной функцией системы \eref{EQ_ODU} в изображениях Лапласа} называется отношение преобразований Лапласа входа и выхода системы при нулевых начальных условиях, причем отношение имеет наименьший порядок.
    Для системы, описываемой уравнением \eref{EQ_ODU}, передаточной функцией является дробно-рациональная функция $W(s)$, в которой были проведены сокращения общих множителей.
    \examp Дана система
    $$
        \ddot y - 2\dot y + y = \dot u - u.
    $$
    Найти передаточную функцию $W(s)$.

    \textit{Решение}
    {
        $$
            W(s)=\frac{y}{u}
        $$
        $$
            W(s)=\frac{s-1}{s^2-2s+1}=\frac{s-1}{(s-1)^2}=\frac{1}{s-1}
        $$
        $\frac{1}{s-1}$ --- это передаточная функция в форме Лапласа
    }

\subsection{Передаточная функция в операторной форме} 

    Из записи уравнения \eref{EQ_ODU} в операторной форме вида
    \begin{equation}\label{EQ_ODU_SYM_1}
        A(s)y = B(s)u,
    \end{equation}
    где 
    $A(s) = s^n + \sum_{i=0}^{n-1}\alpha_is^i$ и 
    $B(s) = \sum_{i=0}^{m}\beta_is^i$ --- ``составные'' операторы дифференцирования.
    Формально разделив \eref{EQ_ODU_SYM_1} на $A(s)$, получим
    \begin{equation}
        y(t) = W(s)u(t),
    \end{equation}
    где 
    $W(s) = \frac{B(s)}{A(s)}$ --- передаточная функция (ПФ) системы \eref{EQ_ODU} в операторной форме.
    Заметим, что ПФ в операторной форме и в изображениях Лапласа совпадают, если полиномы $A(s)$ и $B(s)$ не имеют общих корней. Однако ПФ в изображениях Лапласа всегда можно получить из ПФ в операторной форме, проведя сокращения числителя и знаменателя. Получить из ПФ в изображениях Лапласа ПФ в операторной форме не всегда возможно.
    \examp Определить передаточные функции звеньев, описываемых уравнениями:
    \begin{tasks}(2)
        \task $\dot y + y = u$
        \task $\ddot y - y = \dot u - u$
    \end{tasks}
    {\bf Решение.}
    В символической форме эти уравнения записываются в виде:
    \begin{tasks}(2)
        \task $(p+1) y = u$
        \task $(p^2-1) y = (p-1) u$
    \end{tasks}
    Их передаточные функции в операторной форме соответственно равны
    $$
        W_1(p)=\frac{1}{s+1}, \ W_2(p)= \frac{p-1}{p^2-1}
    $$
    Передаточные функции в изображениях Лапласа имеют вид
    $$
        \left.W_1(s)=W_1(p)\right\vert_{p=s} = \frac{1}{s+1}, \ 
        \left.W_2(s)=W_2(p)\right\vert_{p=s} = \frac{s-1}{s^2-1} = \frac{1}{s+1}.
    $$

\subsection{Временные функции: переходная и весовая функции} 

    Кроме дифференциальных уравнений и передаточных функций при описании и исследовании линейных систем используют переходные и импульсные переходные функции и их графики - временные характеристики.
    Для линейных систем справедлив {\it принцип суперпозиции \cite[стр. 35]{kim:uch}}. 

    \defi{\it Переходная функция} $h(t)$  - функция, описывающая реакцию системы (звена) на единичное ступенчатое воздействие при нулевых начальных условиях. 
    График переходной функции - кривую зависимости $h(t)$ от времени $t$ - называют {\it переходной} или {\it разгонной характеристикой}.
    \defi{\it Импульсная переходная (весовая) функция $w(t)$} - функция, описывающая реакцию системы (звена) на единичное импульсное воздействие ($\delta(t)$) при нулевых начальных условиях, $x(0) = 0$.\\ 
    График импульсной переходной функции $w(t)$ называют {\it импульсной переходной характеристикой}.
    Данные функции связаны соотношением $w(t) = \frac{dh(t)}{dt}$.

\subsection{Временные функции и ПФ в изображениях Лапласа }

    По определению ПФ имеем
    $$
        Y(s) = W(s)U(s).
    $$
    По определению переходной функции вход имеет вид 
    $u(t) = \IT{X}(t)$ 
    (а~$h(t) = y(t)$), а значит 
    $U(s) = \LAP{u(t)} = \frac{1}{s}$, поэтому
    $$
        Y(s) = \frac{W(s)}{s},
    $$
    откуда с помощью обратного преобразования Лапласа получаем 
    $h(t) = \INVLAP{\frac{W(s)}{s}}$.
    Аналогично для весовой функции: 
    $u(t) = \delta(t)$ 
    (a $\omega(t) = y(t)$), тогда $U(s)=1$. Получим, что
    $$
        Y(s) = W(s),
    $$
    откуда 
    $\omega(t) = \INVLAP{W(s)}$.
    Таким образом, имея хотя бы одну из функций ($h(t), \omega(t)$ или $W(s)$), можно восстановить другие.

    \examp Дана система
    $$
        \ddot y - y = \dot u + u.
    $$
    Найти $h(t)$ и $w(t)$.

    \textit{Решение}

    Для определения переходной функции нужно решить уравнение при входном воздействии $u(t)=1$ и нулевых начальных условиях, $x_0 = 0$:
    $$
        (p^2-1)y=1\quad y(0)=\dot y(0)=0
    $$
    $$
        p^2-1=0\quad p=\pm1\quad y_\text{о.о.}=C_1\cdot e^{-t}+C_2\cdot e^t\quad y_\text{ч.р.}=A=-1
    $$
    Получаем решение данного уравнения:

    \begin{align*}
        y &= C_1\cdot e^{-t}+C_2\cdot e^t-1     \\
        \dot y &= -C_1\cdot e^{-t}+C_2\cdot e^t
    \end{align*}
    \begin{align*}
        \begin{cases}
          C_1+C_2-1 = 0\\
         -C_1+C_2   = 0
        \end{cases}
    \end{align*}
    \[
        C_1=C_2={1\over2}
    \]
    \[
        y=h(t) \quad h(t)=\frac{1}{2}\cdot(e^t+e^{-t})-1
    \]
    \[
        w(t)=\frac{h(t)}{dt} \quad w(t)=\frac{1}{2}(e^t-e^{-t})
    \]
    \textit{Ответ:}
    $h(t)=\frac{1}{2}\cdot(e^t+e^{-t})-1$, $w(t)=\frac{1}{2}(e^t-e^{-t})$

\section{Частотные функции}

    Еще один распространенный способ описания динамических систем --- это {\it частотные функции}.
    Пусть дана ПФ $W(s)$. Функция 
    $W(j\omega), \omega\in\BF{R}$ 
    называется {\it частотной передаточной функцией} (ЧПФ), а переменная $\omega$ называется {\it частотой}.
    \defi{\it Частотная передаточная функция (ЧПФ)} - функция W($j\omega$), являющаяся комплекснозначной функцией от действительной переменной $\omega$ --- частоты. 
    Представим ЧПФ в виде
    $$
        W(j\omega) = U(\omega) + jV(\omega) = A(\omega)e^{j\varphi(\omega)},
    $$
    где 
    $U(\omega)$ и $V(\omega)$ 
    --- {\it вещественная и мнимая частотные функции}, 
    $A(\omega) = |W(j\omega)| = \sqrt{U^2(\omega)+V^2(\omega)}$ 
    --- {\it амплитудная частотная функция}, 
    $\varphi(\omega) = \arg{W(j\omega)}$ (при 
    $|\arg{W(j\omega)}| \le \frac{\pi}{2}$ верно 
    $\varphi(\omega) = arctg\left(\frac{V(\omega)}{U(\omega)}\right)$) 
    --- фазовая частотная функция.
    График для каждой частотной функции называется {\it характеристикой}.\par
    Если линейная стационарная система устойчива, то входные гармонические сигналы после окончания переходного процесса переходят в гармонические сигналы с той же частотой, но со сдвигом по фазе и другой амплитудой. Это преобразование характеризует частотная функция 
    $W(j\omega)$.
    Пусть вход 
    $u(t) = u_0 \cos(\omega t + \alpha)$ 
    --- гармонический сигнал. Найдем выход $y(t)$ линейной системы вида
    \begin{equation}\label{EQ_ODU_SYM_2}
        Q(s)y = R(s)u,
    \end{equation}
    при гармоническом воздействии (здесь 
    $Q(s) = s^n + \sum_{i=0}^{n-1}\alpha_is^i,\quad R(s) = \sum_{i=0}^{m}\beta_is^i, \quad s=\frac{d}{dt}$). 
    Пользуясь {\it принципом суперпозиции} для последнего уравнения, найдем выход $y(t)$ как сумму двух выходов при воздействиях 
    $u_1(t) = u_0e^{j(\omega t+\alpha)}$ и 
    $u_2(t) = u_0e^{-j(\omega t+\alpha)}$ (заметим, 
    $u(t) = \frac{u_1(t)+u_2(t)}{2}$).\par
    Тогда в правой части уравнения имеем
    $$
        R(s)u_1(t) = u_1(t)R(j\omega),\quad R(s)u_2(t) = u_2(t)R(-j\omega).
    $$
    Решения будем искать в виде $y_1(t) = A u_0e^{j(\omega t + \alpha + \varphi)} = Ae^{j\varphi}u_1(t)$ и $y_2(t) = A u_0e^{-j(\omega t + \alpha + \varphi)} = Ae^{-j\varphi}u_2(t)$, где $\varphi$ и $A$ --- параметры, подлежащие определению.

    В левых частях уравнений получим $Q(s)y_1(t) = Ae^{j\varphi}u_1(t)Q(j\omega)$ и $Q(s)y_2(t) = Ae^{j\varphi}u_2(t)Q(-j\omega)$. Таким образом, имеем два равенства
    $$
        Ae^{j\varphi} u_1(t)Q(j\omega) = u_1(t)R(j\omega),\quad Ae^{-j\varphi} u_2(t)Q(-j\omega) = u_2(t)R(-j\omega),
    $$
    что эквивалентно
    $$
        Ae^{j\varphi} = W(j\omega),\quad Ae^{-j\varphi} = W(-j\omega),
    $$
    откуда следует, что 
    $$
        A = |W(j\omega)| = |W(-j\omega)|
    $$ 
    и 
    $\varphi = \arg W(j\omega) = -\arg W(-j\omega)$. В итоге,
    $$
        y_1(t) = Au_0e^{j(\omega t + \alpha + \varphi)},\quad
        y_2(t) = Au_0e^{-j(\omega t + \alpha + \varphi)}.
    $$
    Следовательно, $y(t) = \frac{y_1(t)+y_2(t)}{2} = u_0|W(j\omega)| \cos(\omega t + \alpha + \arg W(j\omega))$.

    Заметим, что найденное решение $y(t)$ является вынужденной составляющей решения уравнения \eref{EQ_ODU_SYM_2}.  В силу того, что в выкладках выше используются ПФ в преобразованиях Лапласа, начальные условия нулевые.

    Кроме вынужденной составляющей в решении есть свободные колебания, которые определяются из начальных условий и полинома $Q(s)$. Это означает, что в реальных системах такое преобразование гармонического сигнала будет явно видно только через некоторое время, т.е. после окончания {\it переходного процесса}. (Это можно увидеть при моделировании линейной системы с входным гармоническим сигналом.)

    \examp На вход системы подается сигнал  $u=2\cdot\sin{0{,}5t}$

    Определить реакцию системы при заданной ПФ:
    \[
        W(s)=\frac{6(s+4)}{(s+1)(0{,}49s^2+0,7s+1)}    
    \]
    \textit{Решение}

    Найдем частную ПФ:
    \[
        W(j\omega)=\frac{6(j\omega+4)}{(j\omega+1)(-0{,}49\omega^2+0{,}7j\omega+1)}
    \]
    при $\omega=0{,}5$ найдем $A(0{,}5)$:
    \begin{multline*}
        A(0{,}5)=\left|\frac{6(0{,}5j+4)}{(0{,}5j+1)(-0{,}49\cdot(0{,}5)^2+0{,}7\cdot5\cdot0{,}5+1)}\right|= \\
        =\frac{6\cdot\sqrt{(0{,}5^2)+16}}{\sqrt{(0{,}5)^2+1}\cdot\sqrt{(-0{,}49\cdot(0{,}5)^2+1)^2+(0{,}7\cdot0{,}5)^2}}\approx22{,}899
    \end{multline*}
    \[
        \varphi(\omega)=arg\ W(j\omega)
    \]

    Так как действительные части перемножаемых комплексных чисел в ЧПФ положительно, то можно воспользоваться арктангенсом для вычисления аргумента.  
    \[
        \varphi(0{,}5)=arctg\left(\frac{0{,}5}{4}\right)-arctg(0{,}5)-arctg\left(\frac{0{,}7\cdot0{,}5}{1-0{,}49\cdot(0{,}5)^2}\right)\approx-0{,}719
    \]

    \textit{Ответ}

    \[
        y=45{,}798(\sin(0{,}5t-0{,}719))
    \]
    %Не сходится с Кимом

\section{Основные типы элементарных звеньев} 

\begin{description}
    \item[Пропорциональное звено]
        $W(s)=k$.  
        $W(j\omega) = k,\; A(\omega) = |k|,\; \varphi(\omega) = 0,\; h(t) = k,\; \omega(t) = k\delta(t);$

    \item[Дифференциальное звено]
        $W(s) = ks$.
        $$
            W(j\omega) = kj\omega,\; A(\omega) = |k|\omega, \; \varphi(\omega) = \frac{\pi}{2},\; h(t) = k\delta(t),\; \omega(t) = k\dot\delta(t);
        $$

    \item[Интегрирующее звено]
        $W(s) = \frac{k}{s}$.
        $$
            W(j\omega) = -\frac{k j}{\omega},\; A(\omega) = \frac{|k|}{\omega},\; \varphi(\omega) = -\frac{\pi}{2},\; h(t) = kt,\; \omega(t) = k;
        $$

    \item[Апериодическое звено] 
        $W(s) = \frac{k}{Ts+1},\; T>0$.
        $$
            \begin{aligned}
                W(j\omega) = \frac{k}{jT\omega+1},\; &A(\omega) = \frac{|k|}{\sqrt{(T\omega)^2+1}},\; \varphi(\omega) = -\arctg(\omega T),\\ h(t) = k(1-&e^{-\frac{t}{T}}),\; \omega(t) = \frac{k}{T}e^{-\frac{t}{T}};
            \end{aligned}
        $$

    \item[Колебательное звено]
        $W(s) = \frac{k}{T^2s^2+2\xi Ts+1},$ $T>0,\; 0 < \xi < 1.$
        $$
            \begin{aligned}
                W(j\omega) &= \frac{k}{1-T^2\omega^2 +j2\xi T\omega},\\
                A(\omega) &= \frac{|k|}{\sqrt{(1-(T\omega)^2)^2 + (2\xi T\omega)^2}},\\
                \varphi(\omega) &=
                \begin{cases}
                    -\arctg(\frac{2\xi T\omega}{1-(T\omega)^2}) & 1 \ge (T\omega)^2,\\
                    -\pi+\arctg(\frac{2\xi T\omega}{(T\omega)^2-1}) & 1 < (T\omega)^2,
                \end{cases}\\
                h(t) &= k\left[1-\frac{\sqrt{\alpha^2+\beta^2}}{\beta} e^{-\alpha t} \sin{(\beta t+\varphi_0)}\right],\\
                \omega(t) &= \frac{k (\alpha^2 + \beta^2)}{\beta} e^{-\alpha t} \sin{\beta  t},
            \end{aligned}
        $$
        $$
            \text{где } \alpha = \frac{\zeta}{T},\ \beta=\frac{\sqrt{1-\zeta^2}}{T},\ \varphi_0=arctg{\frac{\sqrt{1-\zeta^2}}{\zeta}}.
        $$

    \item[Звено чистого запаздывания]
        $W(s) = ke^{-\tau s},\; \tau > 0$. Функции описывающие её
        $$
            \begin{aligned}
                W(j\omega) &= ke^{-j\tau\omega},\\
                A(\omega) = k,&\; \varphi(\omega) = -\tau\omega,\\
                h(t) = k\IT{X}(t-\tau),&\; \omega(t) = k\delta(t-\tau).
            \end{aligned}
        $$

        Это классический способ описания чистого или транспортного запаздывания в системе: воздействие сигнала происходит не в тот же момент, а через некоторое время $\tau$.
\end{description}

\section{Структурные схемы и дифференциальные уравнения систем управления}

    \defi{\it Структурной схемой} системы управления называют графическое изображение её математической модели (ММ) в виде прямоугольников и кругов, обозначающих звенья её математической модели, с указанием входов и выходов. Причем кругами обозначают только сумматоры --- звенья, которые имеют не менее двух входов и один выход и в которых происходит сложение или вычитание входных сигналов.

    \begin{figure}[h]
        \centering
        \includegraphics[width=6.5cm]{sum_minus.pdf}
        \includegraphics[width=6.5cm]{sum_three.pdf}
        \caption{Примеры структурных схем}
        \centering
    \end{figure}

\subsection{Преобразование структурных схем}

    Как любое другое звено, сумматор обладает ПФ. Для первого рисунка это передаточная функция с двумя входами и одним выходом вида
    $$
        W(s) =
        \begin{pmatrix}
            W_{ye}(s)\\
            W_{ge}(s)
        \end{pmatrix}^T =
        \begin{pmatrix}
            -1\\
            1
        \end{pmatrix}^T.
    $$
    Соответственно, получаем 
    $e = W(s)\begin{pmatrix}y\\g\end{pmatrix} = -y+g$.

    Для второго рисунка это
    $$
        W(s) =
        \begin{pmatrix}
            W_{vz}(s)\\
            W_{xz}(s)\\
            W_{fz}(s)
        \end{pmatrix}^T =
        \begin{pmatrix}
            1\\
            1\\
            1
        \end{pmatrix}^T.
    $$
    Соответственно, 
    $z = W(s) \cdot (v,\; x,\; f)^T= v+x+f$.

    \defi{\it Последовательное соединение} - соединение, при котором выходная переменная предшествующего звена является входной переменной последующего звена.
    \begin{figure}[h]
        \centering
        \includegraphics[width=6.5cm]{series_connection.pdf}
        \includegraphics[width=3.5cm]{sconnection_whole.pdf}
        \caption{Примеры структурных схем}
        \centering
    \end{figure}
    При последовательном соединении ПФ между сигналами $x_0$ и $x_n$ вычисляется по формуле 
    $W = W_1\cdot W_2\cdot \ldots\cdot W_n$. Это следует из определения звена.
    \defi{\it Параллельное соединение} - соединение, при котором на входы всех звеньев подается одно и то же воздействие, а их выходные переменные складываются.
    \begin{figure}[h]
        \begin{minipage}[h]{0.39\linewidth}
            \includegraphics[width=5cm]{parallel_connection.pdf}
        \end{minipage}
        \begin{minipage}[h]{0.59\linewidth}
            \includegraphics[width=5cm]{pconnection_whole.pdf}\\
            При параллельном соединении ПФ вычисляется по формуле 
            $W = W_1+W_2+\ldots + W_n$.
        \end{minipage}
    \end{figure}
    \defi{\it Обратное соединение} - соединение двух звеньев, при котором выход звена прямой цепи подается на вход звена обратной связи, выход которого складывается с входом первого звена.
    \begin{figure}[h]
        \begin{minipage}[h]{0.39\linewidth}
            \includegraphics[width=4.5cm]{feedback.pdf}
        \end{minipage}
        \begin{minipage}[h]{0.60\linewidth}
            Если разомкнуть цепь у сумматора после блока $W_2$, получим цепь последовательно соединенных звеньев с передаточной функцией 
            $W_{\text{р}} = W_1 \cdot W_2$, 
            называемой {\it передаточной функцией размокнутого контура}.
        \end{minipage}
    \end{figure}

    Легко найти звено, которое описывает такое обратное соединение, из следующих уравнений (записано для {\it отрицательной обратной связи}):
    $$
        y = W_1 e, \quad e = g- W_2 y.
    $$
    Откуда $y = W_{yg}g$, где
    $$
        W_{yg} = \frac{W_1}{1+W_1 W_2}.
    $$
    Для положительной обратной связи $W_{yg}$ определяется аналогично.\\\\
    {\bf Перенос сумматора}. Перенос сумматора бывает двух видов: по ходу сигнала и против хода сигнала. В первом случае добавляется звено с передаточной функцией, равной передаточной функции звена, через которое переносится сумматор.

    \begin{figure}[h]
        \begin{minipage}[h]{0.45\linewidth}
            \includegraphics[width=4.5cm]{trans_sum_direct_before.pdf}
        \end{minipage}
        $\Longrightarrow$
        \begin{minipage}[h]{0.45\linewidth}
            \includegraphics[width=4.5cm]{trans_sum_direct_after.pdf}
        \end{minipage}
        \caption{Выходной сигнал $y$ при таких преобразованиях остается неизменным.}
    \end{figure}
    При переносе сумматора против хода сигнала добавляется звено с передаточной функцией, равной обратной передаточной функции звена, через которое переносится сумматор.  
    \begin{figure}[h]
        \begin{minipage}[h]{0.45\linewidth}
           \includegraphics[width=4.5cm]{trans_sum_indirect_before.pdf}
        \end{minipage}
        $\Longrightarrow$
        \begin{minipage}[h]{0.45\linewidth}
            \includegraphics[width=4.5cm]{trans_sum_indirect_after.pdf}
        \end{minipage}
    \end{figure}\\
    {\bf Перенос узла}. Перенос узла, как и сумматора, бывает двух видов: по ходу сигнала и против хода сигнала. При переносе узла по ходу сигнала добавляется звено с передаточной функцией звена, равной обратной передаточной функции звена, через которое переносится узел.
    \begin{figure}[h]
        \begin{minipage}[h]{0.45\linewidth}
            \includegraphics[width=4.5cm]{trans_branch_direct_before.pdf}
        \end{minipage}
    $\Longrightarrow$
        \begin{minipage}[h]{0.45\linewidth}
            \includegraphics[width=4.5cm]{trans_branch_direct_after.pdf}
        \end{minipage}
        \caption{Аналогично, выходной сигнал $y$ при таких преобразованиях остается неизменным.}
    \end{figure}

    При переносе узла против хода  добавляется звено с передаточной функцией звена, равной передаточной функции звена, через которое переносится узел. 
    \begin{figure}[h]
        \begin{minipage}[h]{0.45\linewidth}
            \includegraphics[width=4.5cm]{trans_branch_indirect_before.pdf}
        \end{minipage}
        $\Longrightarrow$
        \begin{minipage}[h]{0.45\linewidth}
            \includegraphics[width=4.5cm]{trans_branch_indirect_after.pdf}
        \end{minipage}
    \end{figure}\\
    {\bf Перестановка сумматоров и узлов}. Перестановка двух сумматоров выполняется в соответствии с сохранением сигнала; перестановка узлов не меняет значения сигналов, поэтому не требует никаких изменений.
    \begin{figure}[h]
        \begin{minipage}[h]{0.45\linewidth}
            \includegraphics[width=4cm]{trans_sum_branch_before.pdf}
        \end{minipage}
        $\Longrightarrow$
        \begin{minipage}[h]{0.45\linewidth}
            \includegraphics[width=4cm]{trans_sum_branch_after.pdf}
        \end{minipage}
        \begin{minipage}[h]{0.45\linewidth}
            \includegraphics[width=4cm]{trans_branch_sum_before.pdf}
        \end{minipage}
    $\Longrightarrow$
        \begin{minipage}[h]{0.45\linewidth}
            \includegraphics[width=4cm]{trans_branch_sum_after.pdf}
        \end{minipage}
    \end{figure}\\

\subsection{Вычисление передаточной функции одноконтурной и многоконтурной систем}

    \defi Замкнутая система называется {\it одноконтурной}, если при ее размыкании в какой-либо точке замкнутого контура получается цепь (схема) без параллельных и обратных соединений.

    \begin{figure}[h]
        \begin{minipage}[h]{0.29\linewidth}
            Рассмотрим пример одноконтурной системы.
            \vspace{3cm}
        \end{minipage}
        \begin{minipage}[h]{0.70\linewidth}
            \includegraphics[width=7cm]{one_contour_exmpl.pdf}
        \end{minipage}
    \end{figure}
    {\bf Правило вычисления передаточной функции замкнутой одноконтурной системы}. 
    Передаточная функция одноконтурной системы относительно внешнего воздействия (входа) $u$ и выхода $х$ равна передаточной функции прямой цепи, деленной на единицу минус передаточная функция контура: $W_{xu}=\frac{W_\text{п}}{1-W_\text{к}}$.

    Тогда передаточная функция системы относительно входа $g$ и выхода $y$ 
    $$W_{gy}=\frac{W_1\cdot W_2}{1+W_1\cdot W_2\cdot W_3},$$
    а для входа $f$ и выхода $e$ 
    $$W_{fe}=\frac{-W_0\cdot W_2\cdot W_3}{1+W_1\cdot W_2\cdot W_3}.$$

    \defi Замкнутая система называется {\it многоконтурной}, если при ее размыкании в какой-либо точке замкнутого контура получается цепь, содержащая хотя бы одно параллельное или обратное соединение. Многоконтурная система бывает двух видов: с перекрестными связями и без перекрестных связей.
    Многоконтурная система {\it не имеет перекрестных связей}, если любые два контура, образованные параллельными или обратными соединениями, не имеют общих участков или если какие-либо два контура имеют общий участок, то один из них вложен внутрь другого.
    \begin{figure}[h]
        \begin{minipage}[h]{0.19\linewidth}
            Рассмотрим пример многоконтурной системы без перекрестных связей.
            \vspace{3cm}
        \end{minipage}
        \begin{minipage}[h]{0.80\linewidth}
            \includegraphics[width=7cm]{many_contour_no_cross_exmpl.pdf}
        \end{minipage}
    \end{figure}
    Многоконтурная система имеет {\it перекрестные связи}, если она содержит два контура, которые имеют общий участок, и при этом ни один из них не вложен внутрь другого.
    \begin{figure}[h]
        \begin{minipage}[h]{0.19\linewidth}
            Рассмотрим пример многоконтурной системы с перекрестными связями.
            \vspace{2cm}
        \end{minipage}
        \begin{minipage}[h]{0.80\linewidth}
            \includegraphics[width=7cm]{many_contour_cross_exmpl.pdf}
        \end{minipage}
    \end{figure}
    \FloatBarrier
    \clearpage

\section{Основные способы математического описания САУ}

    \begin{enumerate}
        \item ОДУ:
            $$
                y^{(n)}+\sum_{i=0}^{n-1}\alpha_iy^{(i)}=\sum_{i=0}^{m}\beta_iu^{(i)},\; m \le n;
            $$
        \item ПФ (в изображениях Лапласа и в операторной форме):
            $$
                W(s) = \frac{\sum_{i=0}^{m}\beta_is^i}{s^n+\sum_{i=0}^{n-1}\alpha_is^{i}} = \frac{\beta(s)}{\alpha(s)};
            $$
        \item Временные функции: $h(t)$ и $\omega(t)$;
        \item Система в пространстве состояний (ПС): ?
    \end{enumerate}

    \begin{center}
    \begin{figure}[H]
        \centering
        \includegraphics[width=7.5cm]{all_desc.pdf}
        \caption
        {    
            {\\\color{blue} Синий цвет}: переходы, которые будут рассмотрены.\\
            {\color{red} Красный цвет}: переходы, которые не будут рассматриваться в курсе.\\
            {\color{green} Зеленый цвет}: переходы, которые уже были рассмотрены.\\
            Прерванная линия означает, что переход возможен при определенных условиях.
        }
    \end{figure}
    \end{center}
    % \FloatBarrier
% \clearpage

\subsection{Описание системы в фазовом пространстве (пространстве состояний)}
    
    Линейный ОУ может быть описан системой дифференциальных уравнений вида
    \begin{equation}\label{ST_DS}
        \begin{cases}
            \dot x = Ax+bu,& x\in\BF{R}^{n},u\in\BF{R},\\
            y = cx +du,& y\in\BF{R},
        \end{cases}
    \end{equation}
    где $u(t)$ и $y(t)$ --- назначаемое управление и соответствующий ему выход, $x(t)$ --- вектор состояния системы или фазовый вектор, матрицы $A,b$ и $c$ соответствующих размерностей, $d$ --- число (в основном везде будем полагать, что $d=0$). Такое описание называют описанием системы в фазовом пространстве.

    Если ОУ линейный нестационарный, то матрицы в \eref{ST_DS} зависят от времени: $A=A(t), b=b(t)$ и $c=c(t)$.

    На второй лекции был рассмотрен перевернутый маятник и его описание в пространстве состояний.

\subsection{Переход от ОДУ к ПС}

    Пусть дано описание ОУ в виде ОДУ  {}
    $y^{(n)}+\sum_{i=0}^{n-1}\alpha_iy^{(i)}=\sum_{i=0}^{m}\beta_iu^{(i)},\;$ $m~\lse~n$. 
    Определим алгоритм перехода от ОДУ к описанию в ПС~\eref{ST_DS}.

    Рассмотрим этот переход для случая\footnote{Для общего случая смотри \cite{pandia}} $n=m=2$. Тогда имеем ОДУ
    \begin{equation}\label{ODU_2}
        \left\{
        \begin{aligned}
            &\ddot y + \alpha_1 \dot y + \alpha_0 y = \beta_2 \ddot{u} + \beta_1 \dot u + \beta_0 u,\\
            &\dot y(0) = y_1,\quad y(0) = y_0,
        \end{aligned}\right.
    \end{equation}
        и требуется перейти к ПС
    \begin{equation}\label{STDS_2}
        \left\{
        \begin{aligned}
            \dot x &= Ax + ku,\\
            y &= cx + du,\\
            x_1(0) &= x_{10},\quad x_2(0) = x_{20},
        \end{aligned}
        \right.
    \end{equation}
    где 
    $A\in\BF{R}^{2\times2}, k, c^T\in\BF{R}^{2\times1}$ 
    и 
    $d,x_{10}, x_{20}\in\BF{R}$ --- 
    параметры, подлежащие определению.

    Выбор параметров $A,b,c$ и $d$ может быть разнообразным, но при этом выходы в описаниях \eref{ODU_2} и \eref{STDS_2} должны совпадать. Рассмотрим один из способов.

    Оказывается, что матрицу $A$ можно выбрать в виде матрицы Фробениуса характеристического полинома ОДУ \eref{ODU_2} (
    $\alpha(s) = s^2+a_1s+a_0$), 
    т.е.
    $$
        A =
        \begin{pmatrix}
            0&    1\\
            -a_0& -a_1
        \end{pmatrix},
    $$
    а $с = (1\; 0)$. Тогда описание \eref{STDS_2} принимает вид
    \begin{equation}\label{EQ1}
        \left\{
        \begin{aligned}
            \dot x_1 &= x_2 + k_1 u,\\
            \dot x_2 &= -a_0x_1-a_1x_2+k_2u\\
            y &= x_1 + du,\\
            x_1(0) &= x_{10},\quad x_2(0) = x_{20}.
        \end{aligned}
        \right.
    \end{equation}

    Чтобы определить параметры $k_1,k_2$ и $d$, выведем уравнение, связывающее $y$ и $u$. Для этого в \eref{EQ1} выразим $x_1$ и $x_2$ через $y$ и $u$:
    $x_1 = y - du$, 
    отсюда 
    $x_2 = \dot y - d\dot u -k_1 u$. 
    В результате получаем уравнение для $y$ и $u$:
    $$
        \ddot y - d \ddot u -k_1\dot u = -a_0 (y-du)-a_1(\dot y - d \dot u - k_1 u)+k_2u.
    $$
    Сгруппируем и приведем подобные:
    $$
        \ddot y +a_1\dot y + \alpha_0 y = d\ddot u + (k_1+a_1d)\dot u + (a_0 d + \alpha_1k_1+k_2)u.
    $$
    Это уравнение должно совпадать с исходным уравнением \eref{ODU_2}, т.е.
    $d = \beta_2,\; k_1 + \alpha_1d = \beta_1,\; \alpha_0 d+a_1k_1+k_2 = \beta_0$. 
    Отсюда окончательные выражения:
    $$
        \left\{
        \begin{aligned}
            d&=\beta_2,\\
            k_1 &= \beta_1 - \alpha_1\beta_2,\\
            k_2 &= \beta_0 - \alpha_0 \beta_2 - \alpha_1 (\beta_1-a_1\beta_2).
        \end{aligned}
        \right.
    $$

    Таким образом, динамика у уравнения \eref{ODU_2} и у системы уравнений \eref{STDS_2} одинакова, однако если не совпадают начальные условия, то выходы все еще будут различны. Поэтому необходимы {\it условия согласования} начальных условий.

    Повторно пользуясь выражениями 
    $x_1 = y - du$ 
    и 
    $x_2 = \dot y - d\dot u -k_1 u$, 
    получим условия согласования
    $$
        \begin{aligned}
            x_{10} &= y_0- \beta_2 u(0),\\
            x_{20} &= y_1-\beta_2\dot u (0) - (\beta_1-a_1\beta_2)u(0).
        \end{aligned}
    $$
    \examp{
    $$
        \ddot y+\dot y+y=\ddot u -1\quad y(0)=y_0;\ \dot y(0)=y_1
    $$\
    }

    \textit{Решение}
    
    {
        Требуется перейти к ПС:
        $$
        \begin{cases}
            \dot x=Ax+ku \\
            y=Cx+du      \\
            x_1(0)=x_{10},\ x_2(0)=x_{20}
        \end{cases}
        $$
        $$
            A=
            \begin{pmatrix}
                0  & 1  \\
                -a_0 & -a_1 \\
            \end{pmatrix}
            =
            \begin{pmatrix}
                0  & 1  \\
                -1 & -1 \\
            \end{pmatrix}\quad 
            C=
            \begin{pmatrix}
                1 & 0 
            \end{pmatrix}
        $$
        Тогда описание ПС примет вид:
        $$
        \begin{cases}
            \dot x_1 = x_2+k_1\cdot u                        \\
            \dot x_2 = (-1)\cdot x_1 -1\cdot x_2 +k_2\cdot u \\
            y = x1+du & x_1(0)=x_{10},\ x_2(0)=x_{20}
        \end{cases}
        $$
        Выразим $x_1$ и $x_2$ через $y$ и $u$:
        $$
            x_1=y-du;\quad x_2=\dot y-d\dot u-k_1 u
        $$
        Получим в результате подстановки:
        $$
            \ddot y - d\ddot u - k_1\dot u=-(y-du)-(\dot y-d\dot u-k1_u)+k_2u
        $$
        $$
            \ddot y + \dot y +y=d\ddot u+(k_1+d)\dot u+(d+k_1+k_2)u
        $$
        Заметим, что уравнение совпадает с исходным.
        $$
            \begin{cases}
                k_1+d=0 & d=1\ k_1=-1\ k_2=0 \\
                d = 1                        \\
                d+k_1+k_2=0
            \end{cases}
        $$ 
        Таким образом получим ПС:
        $$
            \begin{cases}
                \dot x = 
                \begin{pmatrix}
                     0 &  1 \\
                    -1 & -1 \\
                \end{pmatrix}
                x+
                \begin{pmatrix}
                    -1 & 0
                \end{pmatrix}^T
                \cdot u          \\
                y = 
                \begin{pmatrix}
                    1 & 0
                \end{pmatrix}
                x + u            \\
                x_1(0)=y_0-u(0)\quad x_2=y_1-\dot u(0)+u(0)
            \end{cases}        
        $$
    }

\subsection{Переход от ПС к ПФ. Инвариантность формы 
ПФ при невырожденном преобразовании вектора состояния}

    Как вычислить ПФ, если система дана в виде, указанном ниже?
    $$
        \left\{
        \begin{aligned}
            \dot x &= Ax+bu,\\
            y&= cx.
        \end{aligned}
        \right.
    $$
    Как и в случае с ОДУ $n$-го порядка, чтобы получить ПФ в изображениях по Лапласу, достаточно взять преобразование от всех уравнений при нулевых начальных условиях. Тогда в обозначениях 
    $X(s)=\LAP{x(t)}, Y(s)=\LAP{y(t)}, U(s) = \LAP{u(t)}$ 
    получим
    $$
        \left\{
        \begin{aligned}
            Xs &= AX+bU,\\
            Y &= cX,
        \end{aligned}
        \right.
    $$
    откуда получаем 
    $X(s) = (sI-A)^{-1}b U(s)$ 
    и 
    $Y(s) = c(sI-A)^{-1}b U(s)$. 
    Последнее соотношение по определению ПФ означает, что
    $$
        W(s) = c (sI-A)^{-1}b = \frac{\beta(s)}{\alpha(s)}.
    $$

    Запись в пространстве состояний содержит ``внутреннюю'' переменную $x(t)$, фазовый вектор. Это даёт возможность выбирать эту переменную в некоторых пределах, например, от $x$ можно перейти к $z=Mx$, где 
    $\det M \neq 0,\quad M\in\BF{R}^{n\times n}$. 
    При этом выход $y$ и вход $u$ системы не изменятся, но изменятся матрицы $A, b$ и $c$. Домножив первое уравнение на $M$ и сделав замену 
    $x=M^{-1}z$, 
    получим:
    $$
        \left\{
        \begin{aligned}
            \dot z &=M AM^{-1}z+Mbu,\\
            y&= cM^{-1}z.
        \end{aligned}
        \right.
    $$
    В новом фазовом пространстве имеем
    $$
        \left\{
        \begin{aligned}
            \dot z &= \overline{A}z+\overline{b}u,\\
            y&= \overline{c}z,
        \end{aligned}
        \right.
    $$
    где 
    $\overline{A} = M AM^{-1},\; \overline{b} = Mb$ 
    и 
    $\overline{c}= cM^{-1}$.

    Вычислим ПФ в новом фазовом пространстве:
    \begin{multline*}
        W(s) = \overline{c}(sI-\overline{A})^{-1}\overline{b} = cM^{-1}(sI-MAM^{-1})^{-1}Mb = \\
        = c M^{-1} (sMM^{-1} - MAM^{-1})^{-1}Mb = c M^{-1}(M(sI-A)M^{-1})^{-1}Mb = \\
        =c(sI-A)^{-1}b.
    \end{multline*}

    Это означает инвариантность ПФ относительно невырожденных преобразований в фазовом пространстве (пространстве состояний).

    \examp
    {
        Выписать ПФ объекта W(s), заданного в ПС:

        \begin{align*}
            \begin{cases}
                \dot x_1=x_2-7x_1+2u, \\
                \dot x_2=7x_1-x_2+3u, \\
                y = x_1
            \end{cases}
        \end{align*}
    }

    \textit{Решение}
    {
        Переход от ПС к ПФ осуществляется по формуле 
        \[
            W(s)=C\cdot(sI-A)\cdot B
        \]
        \[
            x(t)=
            \begin{pmatrix}
                x_1(t) \\
                x_2(t)
            \end{pmatrix}
            \quad
            A=
            \begin{pmatrix}
                -7 &  1 \\
                 7 & -1                
            \end{pmatrix}
            \quad
            B=
            \begin{pmatrix}
                2 \\ 3                
            \end{pmatrix}
            \quad
            C=
            \begin{pmatrix}
                1 & 0               
            \end{pmatrix}
        \]
        \[
            (sI-A)=
            \begin{pmatrix}
                s+7 & -1  \\
                -7  & s+1                
            \end{pmatrix}
            \cdot
            \begin{pmatrix}
                sI-A                
            \end{pmatrix}^T
            =
            \begin{pmatrix}
                s+1 & 1   \\
                7   & s+7                
            \end{pmatrix}
        \]
        \[
            det(sI-A)=(s+7)(s+1)-7
        \]
        \begin{multline*}
            W(s)=
            \begin{pmatrix}
                1 & 0               
            \end{pmatrix}
            \cdot
            \begin{pmatrix}
                s+1 & 1   \\
                7   & s+7               
            \end{pmatrix}
            \cdot
            \begin{pmatrix}
                2 \\ 3               
            \end{pmatrix}
            \cdot
            \frac{1}{(s+7)(s+1)-7}
            =\\=
            \begin{pmatrix}
                s+1 & 1               
            \end{pmatrix}
            \cdot
            \begin{pmatrix}
                2 \\ 3              
            \end{pmatrix}
            \cdot
            \frac{1}{(s+7)(s+1)-7}
            \frac{2(s+1)+3}{s^2+8s}=
            \frac{2s+5}{s^2+8s}.
        \end{multline*}
            
        \textit{Ответ:} $W(s)=\frac{2s+5}{s^2+8s}.$
    }

\subsection{Формулы вычисления реакции системы}

    В ПС существует удобная формула для выражения реакции системы, которая опирается на формулу Коши для решения линейной системы уравнений. Для уравнения 
    $\dot x = Ax + bu, x(0) = x_0$ 
    она принимает вид
    $$
        x(t) = e^{At}x_0 + \int\limits_{0}^{t} e^{A(t-\tau)}bu(\tau)d\tau,
    $$
    где 
    $e^{At} = I+\frac{1}{1!}At + \frac{1}{2!}(At)^{2} + \ldots$ --- 
    матричная экспонента.
    Тогда реакция системы выражается как
    \begin{equation}\label{REACT}
        y(t) = ce^{At}x_0 + c\int\limits_{0}^{t} e^{A(t-\tau)}bu(\tau)d\tau.
    \end{equation}

    Для ПФ выполнено 
    $Y(s) = W(s)U(s)$. 
    После применения обратного преобразования Лапласа при нулевых начальных условиях, $x_0=0$, к последнему соотношению получим
    $$
        y(t) = \IT{L}^{-1}\{W(s)U(s)\} = \int\limits_{0}^t\omega(t-\tau)u(\tau)d\tau.
    $$

    Таким образом, свертка весовой функции и входного воздействия равна реакции системы.

\subsection{Переход от ПС к временным функциям}

    % Для ПФ выполнено 
    % $Y(s) = W(s)U(s)$. 
    % После применения обратного преобразования Лапласа при нулевых начальных условиях, $x_0=0$, к последнему соотношению получим
    % $$
    %     y(t) = \IT{L}^{-1}\{W(s)U(s)\} = \int\limits_{0}^t\omega(t-\tau)u(\tau)d\tau.
    % $$

    % Таким образом, свертка весовой функции и входного воздействия равна реакции системы.

    Из \ref{REACT} легко получить, что при $u(t) = x(t)$ и $x_0 = 0$
    $$
        h(t) = c \int\limits_{0}^{t} e^{A(t-\tau)}Bx(\tau)d\tau = ce^{At} \int\limits_{0}^{t} e^{-A\tau}d\tau B = ce^{At}(\left(-A)^{-1}e^{-A\tau}\right\rvert_0^t)B = c(A^{-1}e^{At}-I)B
    $$

    Аналогично, для весовой функции $\omega(t)$:
    $$
        \omega(t) = c \int\limits_0^t e^{A(t-\tau)}B\delta(\tau)d\tau = ce^{At}B
    $$
%chapter математическое_описание_непрерывных_систем_уравнений (end)
\end{document}